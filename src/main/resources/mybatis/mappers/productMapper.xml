<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.saeromteo.app.product">

	<!-- 모든 상품 정보 조회 -->
	<select id="readAll" resultType="productresponsevo">
		SELECT * FROM PRODUCT;
	</select>

	<!-- 특정 productCode에 해당하는 상품 정보 조회 -->
	<select id="readByProductCode" parameterType="int" resultType="productresponsevo">
		SELECT * FROM PRODUCT WHERE PRODUCTCODE = #{productCode};
	</select>

	<!-- 특정 categoryNumber에 해당하는 상품 정보 조회 -->
	<select id="readByCategory" parameterType="int" resultType="productresponsevo">
		SELECT * FROM PRODUCT WHERE CATEGORYNUMBER = #{categoryNumber};
	</select>

	<!-- 새로운 상품 정보 삽입 -->
	<insert id="insertProduct" parameterType="productrequestvo">
		INSERT INTO PRODUCT (PRODUCTCODE, PRODUCTNAME, PRODUCTPRICE,
		STOCKQUANTITY, REGISTRATIONDATE, ENVMARK, THUMBNAIL, DETAILIMAGE,
		CATEGORYNUMBER, DISCOUNTCODE)
		VALUES (#{productCode}, #{productName}, #{productPrice}, #{stockQuantity},
		#{registrationDate}, #{envMark}, #{thumbnail}, #{detailImage},
		#{categoryNumber}, #{discountCode});
	</insert>

	<!-- 기존 상품 정보 수정 -->
	<update id="updateProduct" parameterType="productrequestvo">
		UPDATE PRODUCT
		SET PRODUCTNAME = #{productName},
		PRODUCTPRICE = #{productPrice},
		STOCKQUANTITY = #{stockQuantity},
		REGISTRATIONDATE = #{registrationDate},
		ENVMARK = #{envMark},
		THUMBNAIL = #{thumbnail},
		DETAILIMAGE = #{detailImage},
		CATEGORYNUMBER = #{categoryNumber},
		DISCOUNTCODE = #{discountCode}
		WHERE PRODUCTCODE = #{productCode};
	</update>

	<!-- 특정 productCode에 해당하는 상품 정보 삭제 -->
	<delete id="deleteProduct" parameterType="int">
		DELETE FROM PRODUCT WHERE PRODUCTCODE = #{productCode};
	</delete>


	<!-- 주문 처리-->
	<insert id="orderProduct"
		parameterType="com.saeromteo.app.model.order.OrderDetailDto$OrderDetailRequest">
		<foreach collection="products" item="product" separator=";">
			INSERT INTO
			ORDERPRODUCT (
			PRODUCT_CODE,
			ORDER_CODE,
			ORDER_QUANTITY,
			PRODUCT_PRICE
			)
			VALUES (
			#{product.productCode},
			#{product.orderCode},
			#{product.orderQuantity},
			#{product.productPrice}
			)
		</foreach>
	</insert>
	

</mapper>